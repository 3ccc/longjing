!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("longjing",[],e):"object"==typeof exports?exports.longjing=e():n.longjing=e()}(window,function(){return function(n){var e={};function t(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return n[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=e,t.d=function(n,e,o){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:o})},t.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=3)}([function(n,e){function t(n){return"[object Array]"===Object.prototype.toString.call(n)}function o(n){return"object"==typeof n&&(t(n)||"[object object]"==Object.prototype.toString.call(n).toLowerCase())}n.exports={isArray:t,isJson:o,parseJson:function(n){if(void 0===n||null==n)return null;if(o(n))return n;try{return JSON.parse(n)}catch(e){return console.log("bridge parseJson function is fail.",e),n}},toStringify:function(n){var e="";try{e="string"==typeof n?n:JSON.stringify(n)}catch(e){console.log("bridge stringify发生异常，stringify的数据为：",n)}return e}}},function(n,e,t){var o=t(0),i={default:this,call:function(n,e,t){var i="";"function"==typeof e&&(t=e,e={});var r={data:void 0===e?null:e};if("function"==typeof t){var a="dscb"+window.dscb++;window[a]=t,r._dscbstub=a}return r=o.toStringify(r),window._dsbridge?i=_dsbridge.call(n,r):(window._dswk||-1!=navigator.userAgent.indexOf("_dsbridge"))&&(i=prompt("_dsbridge="+n,r)),o.parseJson(i||"{}").data},register:function(n,e,t){var o=t?window._dsaf:window._dsf;window._dsInit||(window._dsInit=!0,setTimeout(function(){i.call("_dsb.dsinit")},0)),"object"==typeof e?o._obs[n]=e:o[n]=e},registerAsyn:function(n,e){this.register(n,e,!0)},hasNativeMethod:function(n,e){return this.call("_dsb.hasNativeMethod",{name:n,type:e||"all"})},disableJavascriptDialogBlock:function(n){this.call("_dsb.disableJavascriptDialogBlock",{disable:!1!==n})}};!function(){if(!window._dsf){var n=window.close,e={_dsf:{_obs:{}},_dsaf:{_obs:{}},dscb:0,longjing:i,close:function(){i.hasNativeMethod("_dsb.closePage")?i.call("_dsb.closePage"):n.call(window)},_handleMessageFromNative:function(n){var e=o.parseJson(n.data),t={id:n.callbackId,complete:!0},r=this._dsf[n.method],a=this._dsaf[n.method],c=function(n,o){t.data=n.call(o,e),i.call("_dsb.returnValue",t)},s=function(n,o){e.push(function(n,e){t.data=n,t.complete=!1!==e,i.call("_dsb.returnValue",t)}),n.call(o,e)};if(r&&"undefined"!=r&&"null"!=r)c(r,this._dsf);else if(a&&"undefined"!=a&&"null"!=a)s(a,this._dsaf);else{var u=n.method.split(".");if(u.length<2)return;var f=u.pop(),l=u.join("."),p=this._dsf._obs,d=p[l]||{},g=d[f];if(g&&"function"==typeof g)return void c(g,d);if((g=(d=(p=this._dsaf._obs)[l]||{})[f])&&"function"==typeof g)return void s(g,d)}}};for(var t in e)window[t]=e[t];i.register("_hasJavascriptMethod",function(n,e){var t=n.split(".");if(t.length<2)return!(!_dsf[t]&&!_dsaf[t]);n=t.pop();var o=t.join("."),i=_dsf._obs[o]||_dsaf._obs[o];return i&&!!i[n]})}}(),n.exports=i},function(n,e,t){var o=t(1),i=t(0),r=window.tianshan&&window.tianshan.invokeApp;r&&(window.ljTsEventAction={},window.onTsEvent=function(){var n;switch(arguments.length){case 1:n="string"==typeof arguments[0]?JSON.parse(arguments[0]):arguments[0],"function"==typeof ljTsEventAction[n.fn]&&(0==n.code?ljTsEventAction[n.fn](n.data):ljTsEventAction[n.fn](n));break;case 2:"function"==typeof ljTsEventAction[arguments[0]]&&ljTsEventAction[arguments[0]](arguments[1])}}),n.exports=function(){var n,e,t,a;window.tianshan&&window.tianshan.invokeApp?(n=function(n,e){return e?JSON.stringify({fn:n,data:e}):JSON.stringify({fn:n})},a=function(){var e=arguments[0],t="object"==typeof arguments[1]?arguments[1]:null,o=null;if("object"==typeof arguments[1]?!0===arguments[2]:!0===arguments[1])try{return void 0!==(o=JSON.parse(window.tianshan.invokeApp(n(e,t)))).code&&0==o.code?o.data||{}:o}catch(i){return console.log(n(e,t),window.tianshan.invokeApp(n(e,t)),"tianshan return data is not json format",i),o}else try{window.tianshan.invokeApp(n(e,t))}catch(o){console.log("app run function has error",n(e,t),o)}}):(n=function(n,e){return e?JSON.stringify({fn:n,data:e}):JSON.stringify({fn:n})},e=function(n){var e=null,t="string"==typeof n?i.parseJson(n):n;try{return 0==(e="string"==typeof(e=t.data?o.call(t.fn,t.data):o.call(t.fn))?i.parseJson(e):e).code?e.data||{}:e}catch(t){return console.log("bridge执行时遇到入参问题，入参："+n+"错误："+t),e}},t=function(n){var e="string"==typeof n?i.parseJson(n):n;try{e.data?o.call(e.fn,e.data):o.call(e.fn)}catch(e){console.log("bridge执行时遇到入参问题，入参："+n+"错误："+e)}},a=function(){var n=arguments[0],o="object"==typeof arguments[1]?arguments[1]:null;if("object"==typeof arguments[1]?!0===arguments[2]:!0===arguments[1])return e({fn:n,data:o});t({fn:n,data:o})});var c={test:function(){return"driver is ok"},getAppID:function(){return a("getAppId",!0)},getPageType:function(){return a("getPageType",!0)},restart:function(){a("restart")},upgrade:function(n){a("upgrade",n)},open:function(n){a("open",n)},quit:function(n){a("quit",n)},readFile:function(n){return a(r?"readFile":"file.read",n,!0)},readConfig:function(){return a("readConfig",!0)},getAppVersion:function(){return a("getAppVersion",!0)},writeConfig:function(n){a("writeConfig",n)},setQuitTime:function(n){a("setQuitTime",n)},notifyMainPage:function(){a("notifyMainPage")},ttsSpeak:function(n){r?a("ttsSpeak",n):o.call("tts.speak",n,function(n){window.ljTsEventAction.TTS_SPEAK&&window.ljTsEventAction.TTS_SPEAK(n)})},loadSuccess:function(n){a("loadSuccess",n)},loaded:function(){a("loaded")},createTimerTask:function(n){a("createTimerTask",n)},stopTimerTask:function(n){a("stopTimerTask",n)},changeLed:function(n){a("changeLed",n)},getDriverVersion:function(){return a("getDriverVersion",!0)},printV1:function(n){a("printV1",n)},printV2:function(n){a("printV2",n)},compareFace1V1:function(n){return a("compareFace1V1",n,!0)},openCameraPreview:function(n){a("openCameraPreview",n)},closeCameraPreview:function(){a("closeCameraPreview")},takePicture:function(n){return a("takePicture",n,!0)},startFaceComparison:function(n){a("startFaceComparison",n)},stopFaceComparison:function(){a("stopFaceComparison")},connectPrinter:function(n){return a("connectPrinter",n,!0)},printTec:function(n){a("printTec",n)}};return function(n,e){return c[n]?"function"==typeof c[n]?c[n](e):c[n]:e?(e.callback&&e.callback(e),e.callbackFn&&e.callbackFn(e),void(e.fn&&e.fn(e))):null}}()},function(n,e,t){var o=t(2),i=t(1),r=window.tianshan&&window.tianshan.invokeApp,a={getDeviceNumber:function(){return this.get().clientNumber||null},getSellerId:function(){return this.get().sellerId||null},getPointNo:function(){return this.get().pointNo||null},get:function(){var n=o("readFile",{path:"sys/client.json"})||{},e={};try{e=JSON.parse(n.content)}catch(t){e=n.content||{}}return e}};var c=o("getAppID"),s={test:function(){return"hello world"},config:function(){var n=function(){var n=e(),t=arguments[0];if("object"==typeof t)for(var i in t)n[i]=t[i];else n[t]=arguments[1];o("writeConfig",{content:JSON.stringify(n)})},e=function(n){if(!function(n){for(var e=["deviceNumber","terminalNo","terminalNO","terminalId","sellerId","pointNo","appid","appId","appID"],t=0,o=e.length;t<o;t++)if(n==e[t])return!0;return!1}(n)){var e=o("readConfig")||{},t={};try{if("string"==typeof e.content){var i=0;t=function n(e){return"object"==typeof e?e:++i<=3?n(JSON.parse(e)):(console.log("JSON字符串深度太深，解析发生异常。"),{})}(JSON.parse(e.content)||{})}else t=e.content||{}}catch(n){t=e.content||{},console.log("读取配置时，数据处理异常")}return n?t[n]||null:t}switch(n){case"deviceNumber":case"terminalNo":case"terminalNO":return a.getDeviceNumber();case"terminalId":break;case"sellerId":return a.getSellerId();case"pointNo":return a.getPointNo();case"appid":case"appId":case"appID":return"object"==typeof c?c.appId||c.id||"":c;default:return null}};switch(arguments.length){case 2:n(arguments[0],arguments[1]);break;case 1:if("object"==typeof arguments[0]&&n(arguments[0]),"string"==typeof arguments[0])return e(arguments[0]);break;case 0:return e()}},getAppVersion:function(){var n=o("getAppVersion");return"object"==typeof n?n.appVersion:n},openChildWindow:function(n){o("open",{type:n.type||"offline",url:n.path})},closeChildWindow:function(n){n?o("quit",{url:n}):o("quit")},refresh:function(n){o("refresh",{path:n})},upgrade:function(n){o("upgrade",{url:n.url}),this.ts("upgradeResult",function(){o("restart")})},setChildWindowAutoCloseSecond:function(n){o("setQuitTime",{time:n.time||n})},refreshMainWindow:function(){o("notifyMainPage")},getPageType:function(){return o("getPageType")},voice:function(n){o("ttsSpeak",n)},loadSuccess:function(n){o("loadSuccess",n)},loaded:function(n){o("loaded",n)},createTimerTask:function(n){o("createTimerTask",n)},stopTimerTask:function(n){o("stopTimerTask",n)},changeLed:function(n){o("changeLed",n)},printV1:function(n){o("printV1",n)},printV2:function(n){o("printV2",n)},getDriverVersion:function(){return o("getDriverVersion")},compareFace1V1:function(n){return o("compareFace1V1",n)},openCameraPreview:function(n){o("openCameraPreview",n)},closeCameraPreview:function(){o("closeCameraPreview")},takePicture:function(n){return o("takePicture",n)},startFaceComparison:function(n){o("startFaceComparison",n)},stopFaceComparison:function(){o("stopFaceComparison")},connectPrinter:function(n){return o("connectPrinter",n)},printTec:function(n){o("printTec",n)},notify:function(n,e,t){switch(n){case"ENTER_SCREENSAVERS":n="inScreensaver";break;case"APP_CMD":n="NOTIFY_APP";break;case"TTS_SPEAK":n="TTS_SPEAK";break;case"APP_SHOW":case"show":n="APP_SHOW";break;case"NOTIFY_TIMER":case"TIMER_NOTIFY":n="TIMER_NOTIFY";break;case"DRIVER_GET_CARD_NUM":n="DRIVER_GET_CARD_NUM";break;case"DRIVER_GET_SCAN_CODE":n="DRIVER_GET_SCAN_CODE";break;case"DRIVER_GET_PRINT_RESULT":n="DRIVER_GET_PRINT_RESULT";break;case"FACE_COMPARISON_RESULT":n="FACE_COMPARISON_RESULT"}r?window.ljTsEventAction[n]=function(n){e&&e(n,t)}:t?i.register(n,t,e):i.register(n,e)},ready:function(n){n()}},u=longjing||{};for(var f in s)u[f]=s[f];n.exports=u}])});